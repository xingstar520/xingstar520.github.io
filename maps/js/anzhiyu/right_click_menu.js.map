{"version":3,"file":"../../../js/anzhiyu/right_click_menu.js","names":["rm","aElements","document","getElementsByTagName","i","length","setAttribute","imgElements","j","showRightMenu","isTrue","x","y","console","info","rightMenu","getElementById","style","top","left","display","stopMaskScroll","hideRightMenu","querySelector","rmWidth","offsetWidth","rmHeight","offsetHeight","reloadrmSize","visibility","domhref","domImgSrc","globalEvent","oncontextmenuFunction","event","body","clientWidth","pageX","clientX","pageY","clientY","$rightMenuOther","$rightMenuPlugin","$rightMenuCopyText","$rightMenuPasteText","$rightMenuCommentText","$rightMenuNewWindow","$rightMenuNewWindowImg","$rightMenuCopyLink","$rightMenuCopyImg","$rightMenuDownloadImg","$rightMenuSearch","$rightMenuSearchBaidu","$rightMenuMusicToggle","$rightMenuMusicBack","$rightMenuMusicForward","$rightMenuMusicPlaylist","$rightMenuMusicCopyMusicName","href","target","imgsrc","currentSrc","pluginMode","selectTextNow","window","getSelection","width","tagName","toLowerCase","navMusicEl","contains","innerWidth","innerHeight","imageToBlob","imageURL","img","Image","c","createElement","ctx","getContext","crossOrigin","src","Promise","resolve","onload","this","naturalWidth","height","naturalHeight","drawImage","toBlob","blob","async","copyImage","item","ClipboardItem","navigator","clipboard","write","addEventListener","e","passive","oncontextmenu","downloadimging","writeClipImg","log","anzhiyu","snackbarShow","setTimeout","copyUrl","id","input","appendChild","text","value","select","setSelectionRange","execCommand","remove","rightmenuCopyText","txt","writeText","copyPageUrl","url","location","selceText","selection","createRange","toString","replaceAll","string","search","replace","split","join","addRightMenuClickEvent","history","back","forward","reload","scrollToDest","translateFn","translatePage","querySelectorAll","forEach","link","origin","toRandomPost","switchCommentBarrage","preventDefault","pasteText","copyright","GLOBAL_CONFIG","copy","languages","copySuccess","rightMenuCommentText","open","copyLink","downloadImage","searchBaidu","musicToggle","musicSkipBack","musicSkipForward","musicGetName","onmouseup","ondblclick","readClipboard","readText","then","clipText","insertAtCaret","elemt","startPos","selectionStart","endPos","selectionEnd","focus","scrollTop","substring","domTop","offsetTop","scrollTo","setText","getElementsByClassName","evt","createEvent","initEvent","inputValue","dispatchEvent","classList","add"],"sources":["js/anzhiyu/right_click_menu.js"],"mappings":"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","ignoreList":[],"sourcesContent":["// 初始化函数\nrm = {};\n\n//禁止图片与超链接拖拽\nlet aElements = document.getElementsByTagName(\"a\");\nfor (let i = 0; i < aElements.length; i++) {\n  aElements[i].setAttribute(\"draggable\", \"false\");\n  let imgElements = aElements[i].getElementsByTagName(\"img\");\n  for (let j = 0; j < imgElements.length; j++) {\n    imgElements[j].setAttribute(\"draggable\", \"false\");\n  }\n}\n\n// 显示菜单\nrm.showRightMenu = function (isTrue, x = 0, y = 0) {\n  console.info(x, y);\n  let rightMenu = document.getElementById(\"rightMenu\");\n  rightMenu.style.top = x + \"px\";\n  rightMenu.style.left = y + \"px\";\n  if (isTrue) {\n    rightMenu.style.display = \"block\";\n    stopMaskScroll();\n  } else {\n    rightMenu.style.display = \"none\";\n  }\n};\n\n// 隐藏菜单\nrm.hideRightMenu = function () {\n  rm.showRightMenu(false);\n  let rightMenuMask = document.querySelector(\"#rightmenu-mask\");\n  rightMenuMask.style.display = \"none\";\n};\n\n// 尺寸\nlet rmWidth = document.getElementById(\"rightMenu\").offsetWidth;\nlet rmHeight = document.getElementById(\"rightMenu\").offsetHeight;\n\n// 重新定义尺寸\nrm.reloadrmSize = function () {\n  rightMenu.style.visibility = \"hidden\";\n  rightMenu.style.display = \"block\";\n  // 获取宽度和高度\n  rmWidth = document.getElementById(\"rightMenu\").offsetWidth;\n  rmHeight = document.getElementById(\"rightMenu\").offsetHeight;\n  rightMenu.style.visibility = \"visible\";\n};\n\n// 获取点击的href\nlet domhref = \"\";\nlet domImgSrc = \"\";\nlet globalEvent = null;\n\nvar oncontextmenuFunction = function (event) {\n  if (document.body.clientWidth > 768) {\n    let pageX = event.clientX + 10; //加10是为了防止显示时鼠标遮在菜单上\n    let pageY = event.clientY;\n\n    //其他额外菜单\n    const $rightMenuOther = document.querySelector(\".rightMenuOther\");\n    const $rightMenuPlugin = document.querySelector(\".rightMenuPlugin\");\n    const $rightMenuCopyText = document.querySelector(\"#menu-copytext\");\n    const $rightMenuPasteText = document.querySelector(\"#menu-pastetext\");\n    const $rightMenuCommentText = document.querySelector(\"#menu-commenttext\");\n    const $rightMenuNewWindow = document.querySelector(\"#menu-newwindow\");\n    const $rightMenuNewWindowImg = document.querySelector(\"#menu-newwindowimg\");\n    const $rightMenuCopyLink = document.querySelector(\"#menu-copylink\");\n    const $rightMenuCopyImg = document.querySelector(\"#menu-copyimg\");\n    const $rightMenuDownloadImg = document.querySelector(\"#menu-downloadimg\");\n    const $rightMenuSearch = document.querySelector(\"#menu-search\");\n    const $rightMenuSearchBaidu = document.querySelector(\"#menu-searchBaidu\");\n    const $rightMenuMusicToggle = document.querySelector(\"#menu-music-toggle\");\n    const $rightMenuMusicBack = document.querySelector(\"#menu-music-back\");\n    const $rightMenuMusicForward = document.querySelector(\"#menu-music-forward\");\n    const $rightMenuMusicPlaylist = document.querySelector(\"#menu-music-playlist\");\n    const $rightMenuMusicCopyMusicName = document.querySelector(\"#menu-music-copyMusicName\");\n\n    let href = event.target.href;\n    let imgsrc = event.target.currentSrc;\n\n    // 判断模式 扩展模式为有事件\n    let pluginMode = false;\n    $rightMenuOther.style.display = \"block\";\n    globalEvent = event;\n\n    // 检查是否需要复制 是否有选中文本\n    if (selectTextNow && window.getSelection()) {\n      pluginMode = true;\n      $rightMenuCopyText.style.display = \"block\";\n      $rightMenuCommentText.style.display = \"block\";\n      $rightMenuSearch.style.display = \"block\";\n      $rightMenuSearchBaidu.style.display = \"block\";\n    } else {\n      $rightMenuCopyText.style.display = \"none\";\n      $rightMenuCommentText.style.display = \"none\";\n      $rightMenuSearchBaidu.style.display = \"none\";\n      $rightMenuSearch.style.display = \"none\";\n    }\n\n    //检查是否右键点击了链接a标签\n    if (href) {\n      pluginMode = true;\n      $rightMenuNewWindow.style.display = \"block\";\n      $rightMenuCopyLink.style.display = \"block\";\n      domhref = href;\n    } else {\n      $rightMenuNewWindow.style.display = \"none\";\n      $rightMenuCopyLink.style.display = \"none\";\n    }\n\n    //检查是否需要复制图片\n    if (imgsrc) {\n      pluginMode = true;\n      $rightMenuCopyImg.style.display = \"block\";\n      $rightMenuDownloadImg.style.display = \"block\";\n      $rightMenuNewWindowImg.style.display = \"block\";\n      document.getElementById(\"rightMenu\").style.width = \"12rem\";\n      domImgSrc = imgsrc;\n    } else {\n      $rightMenuCopyImg.style.display = \"none\";\n      $rightMenuDownloadImg.style.display = \"none\";\n      $rightMenuNewWindowImg.style.display = \"none\";\n    }\n\n    // 判断是否为输入框\n    if (event.target.tagName.toLowerCase() === \"input\" || event.target.tagName.toLowerCase() === \"textarea\") {\n      pluginMode = true;\n      $rightMenuPasteText.style.display = \"block\";\n    } else {\n      $rightMenuPasteText.style.display = \"none\";\n    }\n    const navMusicEl = document.querySelector(\"#nav-music\");\n    //判断是否是音乐\n    if (navMusicEl && navMusicEl.contains(event.target)) {\n      pluginMode = true;\n      $rightMenuMusicToggle.style.display = \"block\";\n      $rightMenuMusicBack.style.display = \"block\";\n      $rightMenuMusicForward.style.display = \"block\";\n      $rightMenuMusicPlaylist.style.display = \"block\";\n      $rightMenuMusicCopyMusicName.style.display = \"block\";\n    } else {\n      $rightMenuMusicToggle.style.display = \"none\";\n      $rightMenuMusicBack.style.display = \"none\";\n      $rightMenuMusicForward.style.display = \"none\";\n      $rightMenuMusicPlaylist.style.display = \"none\";\n      $rightMenuMusicCopyMusicName.style.display = \"none\";\n    }\n\n    // 如果不是扩展模式则隐藏扩展模块\n    if (pluginMode) {\n      $rightMenuOther.style.display = \"none\";\n      $rightMenuPlugin.style.display = \"block\";\n    } else {\n      $rightMenuPlugin.style.display = \"none\";\n    }\n\n    rm.reloadrmSize();\n\n    // 鼠标默认显示在鼠标右下方，当鼠标靠右或靠下时，将菜单显示在鼠标左方\\上方\n    if (pageX + rmWidth > window.innerWidth) {\n      pageX -= rmWidth + 10;\n    }\n    if (pageY + rmHeight > window.innerHeight) {\n      pageY -= pageY + rmHeight - window.innerHeight;\n    }\n\n    rm.showRightMenu(true, pageY, pageX);\n    document.getElementById(\"rightmenu-mask\").style.display = \"flex\";\n    return false;\n  }\n};\n\n// 监听右键初始化\nwindow.oncontextmenu = oncontextmenuFunction;\n\n// 下载图片状态\nrm.downloadimging = false;\n\n// 复制图片到剪贴板\nrm.writeClipImg = function (imgsrc) {\n  console.log(\"按下复制\");\n  rm.hideRightMenu();\n  anzhiyu.snackbarShow(\"正在下载中，请稍后\", false, 10000);\n  if (rm.downloadimging == false) {\n    rm.downloadimging = true;\n    setTimeout(function () {\n      copyImage(imgsrc);\n      anzhiyu.snackbarShow(\"复制成功！图片已添加盲水印，请遵守版权协议\");\n      rm.downloadimging = false;\n    }, \"10000\");\n  }\n};\n\nfunction imageToBlob(imageURL) {\n  const img = new Image();\n  const c = document.createElement(\"canvas\");\n  const ctx = c.getContext(\"2d\");\n  img.crossOrigin = \"\";\n  img.src = imageURL;\n  return new Promise(resolve => {\n    img.onload = function () {\n      c.width = this.naturalWidth;\n      c.height = this.naturalHeight;\n      ctx.drawImage(this, 0, 0);\n      c.toBlob(\n        blob => {\n          // here the image is a blob\n          resolve(blob);\n        },\n        \"image/png\",\n        0.75\n      );\n    };\n  });\n}\n\nasync function copyImage(imageURL) {\n  const blob = await imageToBlob(imageURL);\n  const item = new ClipboardItem({ \"image/png\": blob });\n  navigator.clipboard.write([item]);\n}\n\nrm.copyUrl = function (id) {\n  const input = document.createElement(\"input\"); // Create a new <input> element\n  input.id = \"copyVal\"; // Set the id of the new element to \"copyVal\"\n  document.body.appendChild(input); // Append the new element to the end of the <body> element\n\n  const text = id;\n  input.value = text;\n  input.select();\n  input.setSelectionRange(0, input.value.length);\n  document.execCommand(\"copy\");\n\n  input.remove(); // Remove the <input> element from the DOM\n};\n\nfunction stopMaskScroll() {\n  if (document.getElementById(\"rightmenu-mask\")) {\n    let xscroll = document.getElementById(\"rightmenu-mask\");\n    xscroll.addEventListener(\n      \"mousewheel\",\n      function (e) {\n        //阻止浏览器默认方法\n        rm.hideRightMenu();\n        // e.preventDefault();\n      },\n      { passive: true }\n    );\n  }\n  if (document.getElementById(\"rightMenu\")) {\n    let xscroll = document.getElementById(\"rightMenu\");\n    xscroll.addEventListener(\n      \"mousewheel\",\n      function (e) {\n        //阻止浏览器默认方法\n        rm.hideRightMenu();\n        // e.preventDefault();\n      },\n      { passive: true }\n    );\n  }\n}\n\nrm.rightmenuCopyText = function (txt) {\n  if (navigator.clipboard) {\n    navigator.clipboard.writeText(txt);\n  }\n  rm.hideRightMenu();\n};\n\nrm.copyPageUrl = function (url) {\n  if (!url) {\n    url = window.location.href;\n  }\n  rm.copyUrl(url);\n  anzhiyu.snackbarShow(\"复制链接地址成功\", false, 2000);\n  rm.hideRightMenu();\n};\n\n// 复制当前选中文本\nvar selectTextNow = \"\";\ndocument.onmouseup = document.ondblclick = selceText;\n\nfunction selceText() {\n  var txt;\n  if (document.selection) {\n    txt = document.selection.createRange().text;\n  } else {\n    txt = window.getSelection().toString();\n  }\n  selectTextNow = txt !== \"\" ? txt : \"\";\n}\n\n// 读取剪切板\nrm.readClipboard = function () {\n  if (navigator.clipboard) {\n    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));\n  }\n};\n\n// 粘贴文本到焦点\nrm.insertAtCaret = function (elemt, value) {\n  const startPos = elemt.selectionStart,\n    endPos = elemt.selectionEnd;\n  if (document.selection) {\n    elemt.focus();\n    var sel = document.selection.createRange();\n    sel.text = value;\n    elemt.focus();\n  } else {\n    if (startPos || startPos == \"0\") {\n      var scrollTop = elemt.scrollTop;\n      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);\n      elemt.focus();\n      elemt.selectionStart = startPos + value.length;\n      elemt.selectionEnd = startPos + value.length;\n      elemt.scrollTop = scrollTop;\n    } else {\n      elemt.value += value;\n      elemt.focus();\n    }\n  }\n};\n\n//粘贴文本\nrm.pasteText = function () {\n  const result = rm.readClipboard() || \"\";\n  rm.hideRightMenu();\n};\n\n//引用到评论\nrm.rightMenuCommentText = function (txt) {\n  rm.hideRightMenu();\n  const postCommentDom = document.getElementById(\"post-comment\");\n  var domTop = postCommentDom.offsetTop;\n  window.scrollTo(0, domTop - 80);\n  if (txt == \"undefined\" || txt == \"null\") txt = \"好棒！\";\n  function setText() {\n    setTimeout(() => {\n      var input = document.getElementsByClassName(\"el-textarea__inner\")[0];\n      if (!input) setText();\n      let evt = document.createEvent(\"HTMLEvents\");\n      evt.initEvent(\"input\", true, true);\n      let inputValue = replaceAll(txt, \"\\n\", \"\\n> \");\n      input.value = \"> \" + inputValue + \"\\n\\n\";\n      input.dispatchEvent(evt);\n      input.focus();\n      input.setSelectionRange(-1, -1);\n      if (document.getElementById(\"comment-tips\")) {\n        document.getElementById(\"comment-tips\").classList.add(\"show\");\n      }\n    }, 100);\n  }\n  setText();\n};\n\n//替换所有内容\nfunction replaceAll(string, search, replace) {\n  return string.split(search).join(replace);\n}\n\n// 百度搜索\nrm.searchBaidu = function () {\n  anzhiyu.snackbarShow(\"即将跳转到百度搜索\", false, 2000);\n  setTimeout(function () {\n    window.open(\"https://www.baidu.com/s?wd=\" + selectTextNow);\n  }, \"2000\");\n  rm.hideRightMenu();\n};\n\n//分享链接\nrm.copyLink = function () {\n  rm.rightmenuCopyText(domhref);\n  anzhiyu.snackbarShow(\"已复制链接地址\");\n};\n\nfunction addRightMenuClickEvent() {\n  // 添加点击事件\n  document.getElementById(\"menu-backward\").addEventListener(\"click\", function () {\n    window.history.back();\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-forward\").addEventListener(\"click\", function () {\n    window.history.forward();\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-refresh\").addEventListener(\"click\", function () {\n    window.location.reload();\n  });\n\n  document.getElementById(\"menu-top\").addEventListener(\"click\", function () {\n    anzhiyu.scrollToDest(0, 500);\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-translate\").addEventListener(\"click\", function () {\n    window.translateFn.translatePage();\n    rm.hideRightMenu();\n  });\n\n  const menuLinks = document.querySelectorAll(\".menu-link\");\n  menuLinks.forEach(function (link) {\n    link.addEventListener(\"click\", rm.hideRightMenu);\n  });\n\n  document.getElementById(\"menu-home\") &&\n    document.getElementById(\"menu-home\").addEventListener(\"click\", function () {\n      window.location.href = window.location.origin;\n    });\n\n  document.getElementById(\"menu-randomPost\").addEventListener(\"click\", function () {\n    toRandomPost();\n  });\n\n  document.getElementById(\"menu-commentBarrage\").addEventListener(\"click\", anzhiyu.switchCommentBarrage);\n\n  document.getElementById(\"rightmenu-mask\").addEventListener(\"click\", rm.hideRightMenu);\n\n  document.getElementById(\"rightmenu-mask\").addEventListener(\"contextmenu\", function (event) {\n    rm.hideRightMenu();\n    event.preventDefault(); // Prevent the default context menu from appearing\n  });\n\n  document.getElementById(\"menu-copy\").addEventListener(\"click\", () => {\n    rm.copyPageUrl();\n  });\n\n  document.getElementById(\"menu-pastetext\").addEventListener(\"click\", rm.pasteText);\n\n  document.getElementById(\"menu-copytext\").addEventListener(\"click\", function () {\n    rm.rightmenuCopyText(selectTextNow);\n    const copyright = GLOBAL_CONFIG.copyright;\n    if (copyright.copy) {\n      anzhiyu.snackbarShow(copyright.languages.copySuccess);\n    }\n  });\n\n  document.getElementById(\"menu-commenttext\").addEventListener(\"click\", function () {\n    rm.rightMenuCommentText(selectTextNow);\n  });\n\n  document.getElementById(\"menu-newwindow\").addEventListener(\"click\", function () {\n    window.open(domhref, \"_blank\");\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-copylink\").addEventListener(\"click\", rm.copyLink);\n\n  document.getElementById(\"menu-downloadimg\").addEventListener(\"click\", function () {\n    anzhiyu.downloadImage(domImgSrc, \"anzhiyu\");\n  });\n\n  document.getElementById(\"menu-newwindowimg\").addEventListener(\"click\", function () {\n    window.open(domImgSrc, \"_blank\");\n    rm.hideRightMenu();\n  });\n\n  document.getElementById(\"menu-copyimg\").addEventListener(\"click\", function () {\n    rm.writeClipImg(domImgSrc);\n  });\n\n  document.getElementById(\"menu-searchBaidu\").addEventListener(\"click\", rm.searchBaidu);\n\n  //音乐\n  document.getElementById(\"menu-music-toggle\").addEventListener(\"click\", anzhiyu.musicToggle);\n\n  document.getElementById(\"menu-music-back\").addEventListener(\"click\", anzhiyu.musicSkipBack);\n\n  document.getElementById(\"menu-music-forward\").addEventListener(\"click\", anzhiyu.musicSkipForward);\n\n  document.getElementById(\"menu-music-copyMusicName\").addEventListener(\"click\", function () {\n    rm.rightmenuCopyText(anzhiyu.musicGetName());\n    anzhiyu.snackbarShow(\"复制歌曲名称成功\", false, 3000);\n  });\n}\n\naddRightMenuClickEvent();\n"]}
function initializeAnniversary(){function t(e,n,a){try{let t=Lunar.fromYmdHms(e,n,a,0,0,0).getSolar();return new Date(t.getYear(),t.getMonth()-1,t.getDay())}catch(l){return t(e,n,a-1)}}function e(t,e){return Math.floor((e-t)/864e5)}function n(e,n,a){return"elapsed"===a?e:function(e,n){const[a,l,r]=e.split("-").map(Number);let o,i=new Date;i=new Date(i.getFullYear(),i.getMonth(),i.getDate()),n?(o=t(i.getFullYear(),l,r),o<i&&(o=t(i.getFullYear()+1,l,r))):(o=new Date(i.getFullYear(),l-1,r),o<i&&(o=new Date(i.getFullYear()+1,l-1,r)));const u=o.toLocaleDateString("zh-CN",{weekday:"long"});return`${o.getFullYear()}-${(o.getMonth()+1).toString().padStart(2,"0")}-${o.getDate().toString().padStart(2,"0")} (${u})`}(e,n)}function a(n,a,l,r){if(0===r){let r=function(n,a){const[l,r,o]=n.split("-").map(Number);let i,u=new Date;return u=new Date(u.getFullYear(),u.getMonth(),u.getDate()),i=a?t(l,r,o):new Date(l,r-1,o),e(i,u)}(a,l);n.textContent=r,n.nextElementSibling.textContent="天了"}else if(1===r){const[r,o,i]=a.split("-").map(Number);let u,g=new Date;g=new Date(g.getFullYear(),g.getMonth(),g.getDate()),u=l?t(r,o,i):new Date(r,o-1,i);let{weeks:s,days:d}=function(t,n){const a=e(t,n);return{weeks:Math.floor(a/7),days:a%7}}(u,g);0===d?(n.textContent=s,n.nextElementSibling.textContent="周了"):(n.textContent=`${s}周${d}天`,n.nextElementSibling.textContent="已")}else if(2===r){const[e,r,o]=a.split("-").map(Number);let i,u=new Date;u=new Date(u.getFullYear(),u.getMonth(),u.getDate()),i=l?t(e,r,o):new Date(e,r-1,o);let{months:g,days:s}=function(t,e){let n=e.getFullYear()-t.getFullYear(),a=e.getMonth()-t.getMonth()+12*n,l=e.getDate()-t.getDate();l<0&&(a-=1,l+=new Date(e.getFullYear(),e.getMonth(),0).getDate());return{months:a,days:l}}(i,u);n.textContent=`${g}月${s}天`,n.nextElementSibling.textContent="已"}}document.querySelectorAll(".countdown").forEach((function(n){const l=n.getAttribute("data-date"),r=n.hasAttribute("data-lunar");if("elapsed"===n.getAttribute("data-display-mode"))n.dataset.displayState="0",a(n,l,r,0),n.addEventListener("click",(function(){let t=parseInt(n.dataset.displayState);t=(t+1)%3,n.dataset.displayState=t.toString(),a(n,l,r,t)}));else{let a=function(n,a){const[l,r,o]=n.split("-").map(Number);let i,u=new Date;return u=new Date(u.getFullYear(),u.getMonth(),u.getDate()),a?(i=t(u.getFullYear(),r,o),i<u&&(i=t(u.getFullYear()+1,r,o))):(i=new Date(u.getFullYear(),r-1,o),i<u&&(i=new Date(u.getFullYear()+1,r-1,o))),e(u,i)}(l,r);n.textContent=a,n.nextElementSibling.textContent="天后"}}));document.querySelectorAll(".target-date").forEach((function(t){const e=t.getAttribute("data-date"),a=t.hasAttribute("data-lunar"),l=t.getAttribute("data-display-mode");t.textContent=n(e,a,l)}))}document.addEventListener("DOMContentLoaded",initializeAnniversary),document.addEventListener("pjax:complete",initializeAnniversary);
//# sourceMappingURL=../../maps/static/js/anniversary.js.map
